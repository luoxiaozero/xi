/*! ArtText v0.0.0 */!function(e){var t={};function o(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=t,o.d=function(e,t,i){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(i,n,function(t){return e[t]}.bind(null,n));return i},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t,o){"use strict";o.r(t);var i=function(){function e(e){this.nodeName="#text",this.text=e}return e.prototype.newDom=function(){return document.createTextNode(this.text)},e.prototype.render=function(e){return"#text"==e.nodeName.toLowerCase()?this.text==e.nodeValue?null:(e.nodeValue=this.text,!1):(e.parentNode.replaceChild(this.newDom(),e),null)},e.prototype.getMd=function(){return this.text},e.prototype.getText=function(){return this.text},e}();function n(){var e=document.createElement("div");e.style.width="100%",e.className="art-tableTool art-shield",e.style.fontSize="14px",e.style.position="relative",e.style.top="8px",e.style.height="0",e.setAttribute("contenteditable","false");var t=document.createElement("input");t.style.width="28px",t.style.height="18px",t.style.marginRight="7px",t.style.marginLeft="7px",t.title="调整行";var o=document.createElement("input");o.style.width="28px",o.style.height="18px",o.style.marginRight="7px",o.title="调整列";var i=document.createElement("span");i.style.width="30px",i.innerHTML='<svg class="icon" style="width: 18px; height: 18px;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1283"><path d="M64.021106 512c0-17.672498 14.07353-31.998785 31.887244-31.998785h832.182277c17.6111 0 31.887244 14.202467 31.887244 31.998785 0 17.672498-14.07353 31.998785-31.887244 31.998785H95.909373c-17.6111 0-31.888268-14.20349-31.888267-31.998785zM959.977871 352.007099c0 17.672498-14.326287 31.998785-31.998785 31.998785s-31.998785-14.326287-31.998785-31.998785V160.016437c0-17.672498-14.326287-31.998785-31.998784-31.998785H160.016437c-17.672498 0-31.998785 14.326287-31.998785 31.998785v191.990662c0 17.672498-14.326287 31.998785-31.998785 31.998785s-31.998785-14.326287-31.998785-31.998785V160.016437c0-53.016471 42.97886-95.995331 95.995332-95.995331H863.981517c53.016471 0 95.995331 42.97886 95.995331 95.995331v191.990662z m0 319.984779v191.990662c0 53.016471-42.97886 95.995331-95.995331 95.995331H160.016437c-53.016471 0-95.995331-42.97886-95.995331-95.995331V671.991878c0-17.672498 14.326287-31.998785 31.998785-31.998785s31.998785 14.326287 31.998784 31.998785v191.990662c0 17.672498 14.326287 31.998785 31.998785 31.998785h703.966103c17.672498 0 31.998785-14.326287 31.998785-31.998785V671.991878c0-17.672498 14.326287-31.998785 31.998785-31.998785s31.996738 14.32731 31.996738 31.998785z" p-id="1284"></path></svg>',i.title="调整大小",i.style.cursor="pointer",i.onclick=r;var n=document.createElement("span");n.appendChild(t),n.appendChild(o),n.style.display="none",i.appendChild(n);var s=document.createElement("span");return s.innerHTML='<svg class="icon" style="width: 18px; height: 18px;color: red;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="689"><path d="M800.162002 316.659033c1.850138-17.575284 17.596773-30.322609 35.172058-28.473495 17.575284 1.850138 30.322609 17.596773 28.473494 35.172058l-57.966202 550.673811c-5.143137 48.856731-46.341445 85.946464-95.467306 85.946464H313.625954c-49.126884 0-90.325192-37.089733-95.468329-85.946464L160.192446 323.358619c-1.850138-17.575284 10.898211-33.32192 28.472471-35.172057 17.575284-1.850138 33.32192 10.898211 35.172058 28.473494l57.965179 550.672788c1.714038 16.285918 15.446807 28.64848 31.822776 28.648481h396.74707c16.375969 0 30.108738-12.363585 31.822776-28.648481l57.967226-550.673811z m-192.176904 99.345636c17.672498 0 31.998785 14.326287 31.998785 31.998785v223.989447c0 17.672498-14.326287 31.998785-31.998785 31.998785s-31.998785-14.326287-31.998785-31.998785V448.00243c0-17.671475 14.326287-31.997762 31.998785-31.997761z m-191.990662 0c17.672498 0 31.998785 14.326287 31.998785 31.998785v223.989447c0 17.672498-14.326287 31.998785-31.998785 31.998785s-31.998785-14.326287-31.998785-31.998785V448.00243c0-17.671475 14.326287-31.997762 31.998785-31.997761z m-31.998785-223.989447h255.987209v-47.998178c0-8.836249-7.163143-15.999392-15.999393-15.999392H399.995043c-8.836249 0-15.999392 7.163143-15.999392 15.999392v47.998178z m-63.996546 0V128.018675c0-35.344996 28.652574-63.996546 63.997569-63.996546h255.987209c35.343973 0 63.996546 28.652574 63.996546 63.996546v63.996547h223.99968c17.672498 0 31.998785 14.326287 31.998785 31.998785s-14.326287 31.998785-31.998785 31.998784H96.019891c-17.672498 0-31.998785-14.326287-31.998785-31.998784s14.326287-31.998785 31.998785-31.998785h223.979214z" p-id="690"></path></svg>',s.title="删除表格",s.style.position="absolute",s.style.right="0",s.style.cursor="pointer",s.onclick=l,e.appendChild(i),e.appendChild(s),e}function s(e){return e?[e.rows.length,e.rows.item(0).cells.length]:[0,0]}function r(e){var t=e.target.parentNode.parentNode;if(t.nextSibling&&"TABLE"==t.nextSibling.nodeName)if("none"===e.target.nextSibling.style.display){e.target.nextSibling.style.display="inline";var o=s(t.nextSibling);e.target.nextSibling.childNodes[0].value=o[0],e.target.nextSibling.childNodes[1].value=o[1]}else!function(e,t){if(-1==t[0]||-1==t[1])return null;var o=s(e);if(console.log(o,t),t[0]!=o[0])if(t[0]<o[0])for(var i=o[0]-1;i>t[0]-1;i--)e.rows[i].parentNode.removeChild(e.rows[i]);else for(i=t[0]-o[0];i>0;i--){for(var n=document.createElement("tr"),r=0;r<o[1];r++){var l=document.createElement("td");n.appendChild(l)}e.appendChild(n)}if(t[1]!=o[1])if(t[1]<o[1])for(i=o[1]-1;i>t[1]-1;i--)for(r=0;r<e.rows.length;r++)console.log(e.rows[r].cells[i]),e.rows[r].cells[i].parentNode.removeChild(e.rows[r].cells[i]);else for(i=t[1]-o[1];i>0;i--)for(r=0;r<e.rows.length;r++)e.rows[r].appendChild(document.createElement("td"))}(t.nextSibling,[parseInt(e.target.nextSibling.childNodes[0].value),parseInt(e.target.nextSibling.childNodes[1].value)]),e.target.nextSibling.style.display="none"}function l(e){var t=e.target.parentNode.parentNode;t.nextSibling&&"TABLE"==t.nextSibling.nodeName&&(t.parentNode.removeChild(t.nextSibling),t.parentNode.removeChild(t))}function a(e){console.log(e)}function d(){var e=document.createElement("div");e.style.width="100%",e.className="art-codeTool art-shield",e.style.fontSize="14px",e.style.position="relative",e.style.top="8px",e.style.height="0",e.setAttribute("contenteditable","false");var t=document.createElement("span");t.innerHTML='<svg class="icon" style="width: 18px; height: 18px;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="714"><path d="M288.010553 735.989447h383.981325c17.672498 0 31.998785 14.326287 31.998784 31.998785s-14.326287 31.998785-31.998784 31.998785H288.010553c-17.672498 0-31.998785-14.326287-31.998785-31.998785s14.326287-31.998785 31.998785-31.998785z m0-159.992901h191.990662c17.672498 0 31.998785 14.326287 31.998785 31.998785s-14.326287 31.998785-31.998785 31.998785H288.010553c-17.672498 0-31.998785-14.326287-31.998785-31.998785s14.326287-31.998785 31.998785-31.998785zM636.111692 92.137467l231.753272 231.753271a95.994308 95.994308 0 0 1 28.116361 67.87897v472.212832c0 53.016471-42.97886 95.995331-95.995332 95.995331H224.014007c-53.016471 0-95.995331-42.97886-95.995332-95.995331V160.016437c0-53.016471 42.97886-95.995331 95.995332-95.995331h344.218715c25.459858 0 49.875944 10.114358 67.87897 28.116361z m-28.116361 62.388932v197.4807h197.4807L607.995331 154.526399z m-53.016471-26.507724H224.014007c-17.672498 0-31.998785 14.326287-31.998785 31.998785v703.966103c0 17.672498 14.326287 31.998785 31.998785 31.998785h575.971986c17.672498 0 31.998785-14.326287 31.998785-31.998785V405.024593v10.980076H607.995331c-35.344996 0-63.996546-28.652574-63.996546-63.996547V128.018675h10.980075z" p-id="715"></path></svg>',t.onclick=h,t.style.cursor="pointer";var o=document.createElement("input");return o.style.width="80px",o.style.height="20px",o.style.marginLeft="7px",o.title="代码语言",o.style.display="none",t.appendChild(o),e.appendChild(t),e}function h(e){console.log(e,this);var t=e.target.parentNode.parentNode;if(t&&"PRE"==t.nextSibling.nodeName)if(console.log(e.target.nextSibling),"none"===e.target.nextSibling.style.display){e.target.nextSibling.style.display="inline";var o=t.nextSibling.childNodes[0].className.substring(5).split(" ")[0];e.target.nextSibling.value=o}else!function(e,t){for(var o=0;o<e.childNodes.length;o++)e.childNodes[o].className="lang-"+t}(t.nextSibling,e.target.nextSibling.value),e.target.nextSibling.style.display="none"}var c=function(e){if(""===e)return[new O("p",{},new O("br"))];for(var t=0;t<B.length;t++)if(e.match(B[t].re))return B[t].fun(e);return null};function u(e,t){var o=window.getSelection().toString();t.style.display="none",window.open("https://www.baidu.com/s?ie=UTF-8&wd="+o)}function p(e,t){return t.style.display="none",document.execCommand("Copy"),!0}function f(e,t){t.style.display="none",document.execCommand("Cut")}function g(e,t){t.style.display="none",document.execCommand("Paste")}function m(e,t){var o=document.createElement("script");o.type="text/javascript",void 0!==t&&(o.onload=function(){t()}),o.src=e,document.body.appendChild(o)}function N(e){var t=document.getElementsByTagName("head")[0],o=document.createElement("link");o.rel="stylesheet",o.type="text/css",o.href=e,t.appendChild(o)}function y(e){var t=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css",o.appendChild(document.createTextNode(e)),t.appendChild(o)}function v(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")>-1}function x(e){S(e,"**")}function b(e){S(e,"*")}function w(e){S(e,"~~")}function T(e){S(e,"__")}function C(e){S(e,"^")}function H(e){S(e,"~")}function S(e,t){var o,i=e.editor.cursor.getSelection();"#text"==i.focusNode.nodeName?(o=(o=i.focusNode.nodeValue).substring(0,i.focusOffset)+t+o.substring(i.focusOffset),i.focusNode.nodeValue=o):(o=(o=i.focusNode.innerText).substring(0,i.focusOffset)+t+o.substring(i.focusOffset),i.focusNode.innerText=o);"#text"==i.anchorNode.nodeName?(o=(o=i.anchorNode.nodeValue).substring(0,i.anchorOffset)+t+o.substring(i.anchorOffset),i.anchorNode.nodeValue=o):(o=(o=i.anchorNode.innerText).substring(0,i.anchorOffset)+t+o.substring(i.anchorOffset),i.anchorNode.innerText=o);e.editor.render(),i.focusInlineOffset+=2*t.length,i.anchorInlineOffset=i.focusInlineOffset,e.editor.cursor.setSelection(i)}function k(e){var t=document.createElement("div");function o(o,i,n){var s=document.createElement("span");s.setAttribute("class","art-floatToolbar-span"),s.innerText=o,s.title=i,s.onmousedown=function(o){return function(){o(e),t.style.display="none"}}(n),t.appendChild(s)}return t.style.width="180px",t.style.position="absolute",t.style.top="10px",t.style.left="10px",t.style.fontWeight="800",t.style.fontSize="17px",t.style.padding="3px 8px",t.style.boxShadow="0 2px 4px rgba(0, 0, 0, .12), 0 0 6px rgba(0, 0, 0, .04)",t.style.transition="all .15s cubic-bezier(0,0,.2,1)",t.style.border="1px solid #e6e6e6",t.style.display="none",o("B","粗体(ctrl+b)",x),o("I","斜体(crtl+i)",b),o("D","删除线(ctrl+shift+d)",w),o("S","下划线(ctrl+u)",T),o("u","上标(ctrl+alt+s)",C),o("d","下标(ctrl+shift+s)",H),t}function E(e,t,o){void 0===o&&(o="null");var i=document.createElement("div");i.style.position="fixed",i.style.boxShadow="0 2px 12px 0 rgba(0, 0, 0, 0.1)",i.style.borderRadius="4px",i.style.left="50%",i.style.margin="-27px 0 0 -170px",i.style.position="fixed !important",i.style.top="40px",i.style.height="40px",i.style.lineHeight="40px",i.style.width="340px",i.style.padding="1px 10px 1px 15px",i.style.transition="opacity .3s,transform .4s,top .4s,-webkit-transform .4s",i.style.zIndex="1000",i.style.overflow="hidden";var n=document.createElement("p");return n.innerHTML=t,n.style.fontSize="13px",n.style.fontWeight="600",n.style.height="100%",n.style.margin="0",i.appendChild(n),"info"==o?(i.style.backgroundColor="#edf2fc",i.style.borderColor="#EBEEF5",i.style.color="#909399"):"success"==o?(i.style.backgroundColor="#f0f9eb",i.style.borderColor="#e1f3d8",i.style.color="#67C23A"):"warning"==o?(i.style.backgroundColor="#fdf6ec",i.style.borderColor="#faecd8",i.style.color="#E6A23C"):"error"==o?(i.style.backgroundColor="#fef0f0",i.style.backgroundColor="#fde2e2",i.style.borderColor="#e1f3d8",i.style.color="#F56C6C"):(i.style.backgroundColor=e.config.theme.get("backgroundColor"),i.style.color="#676767"),setTimeout((function(){e.container.removeChild(i)}),3e3),e.container.appendChild(i),i}var M=function(){function e(e){this.artText=e,this.root=document.createElement("div"),this.root.style.position="fixed",this.root.style.zIndex="10",this.root.style.width="60vw",this.root.style.right="20vw",this.root.style.height="92vh",this.root.style.top="4vh",this.root.style.backgroundColor="#fff",this.root.style.boxShadow="0 2px 4px rgba(0, 0, 0, .12), 0 0 6px rgba(0, 0, 0, .04)",this.root.style.borderRadius="2px",this.root.style.zIndex="5",this.root.style.display="none",this.maskLayer=document.createElement("div"),this.maskLayer.style.position="fixed",this.maskLayer.style.top="0",this.maskLayer.style.right="0",this.maskLayer.style.bottom="0",this.maskLayer.style.left="0",this.maskLayer.style.background="rgba(26,26,26,.65)",this.maskLayer.style.zIndex="1",this.maskLayer.style.display="none";var t,o=document.createElement("span");o.style.position="absolute",o.style.right="-60px",o.style.padding="12px",o.style.cursor="pointer",o.style.color="#fff",o.innerHTML='<svg class="icon" style="width: 30px; height: 30px;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1187"><path d="M557.252647 512l135.75794 135.75794c12.495592 12.495592 12.495592 32.757055 0 45.252647-12.495592 12.495592-32.757055 12.495592-45.252647 0L512 557.252647 376.24206 693.010587c-12.496615 12.496615-32.757055 12.495592-45.252647 0-12.495592-12.495592-12.496615-32.756031 0-45.252647l135.75794-135.75794L330.989413 376.24206c-12.496615-12.496615-12.495592-32.757055 0-45.252647 12.495592-12.495592 32.756031-12.496615 45.252647 0l135.75794 135.75794 135.75794-135.75794c12.495592-12.495592 32.756031-12.495592 45.252647 0 12.495592 12.495592 12.495592 32.757055 0 45.252647L557.252647 512z m-429.233972 0c0 212.062813 171.918511 383.981325 383.981325 383.981325s383.981325-171.918511 383.981325-383.981325S724.06179 128.018675 512 128.018675 128.018675 299.937187 128.018675 512z m-63.997569 0c0-247.406786 200.572108-447.978894 447.978894-447.978894S959.977871 264.593214 959.977871 512 759.405763 959.977871 512 959.977871 64.021106 759.405763 64.021106 512z" p-id="1188"></path></svg>',o.onclick=(t=this,function(){t.close()});var i=document.createElement("div");i.style.display="flex",i.style.width="210px",i.style.flexDirection="column",i.style.borderRight="1px solid #ebebeb";var n=document.createElement("div");n.style.padding="12px 20px",n.style.fontWeight="600",n.style.display="flex",n.innerHTML="历史版本";var s=document.createElement("div");s.style.display="flex",s.style.flexDirection="column",s.style.justifyContent="center",s.style.overflow="auto",this.sideDraftHistoryDirectory=document.createElement("div"),s.appendChild(this.sideDraftHistoryDirectory),this.sideDraftHistoryDirectory.style.overflow="auto",null!=localStorage.art_articles?this.art_articles=JSON.parse(localStorage.art_articles):(this.art_articles={},localStorage.art_articles=JSON.stringify(this.art_articles)),i.appendChild(n),i.appendChild(s);var r=document.createElement("div");r.style.flex="1 1",r.style.display="flex",r.style.flexDirection="column",r.style.overflow="auto",this.mainArticle=document.createElement("div"),this.mainArticle.style.flex="1 1",this.mainArticle.style.display="flex",this.mainArticle.style.overflow="auto",this.mainArticle.innerHTML='<textarea style="width: 100%;border: none;resize: none;outline: none;padding:13px 15px;font-size: 15px" readonly>无打开</textarea>',this.mainFooter=document.createElement("div"),this.mainFooter.style.height="52px",this.mainFooter.style.display="flex",this.mainFooter.style.borderTop="1px solid #ebebeb",this.mainFooter.style.alignItems="center",this.mainFooter.style.padding="0 20px",this.footerDel=document.createElement("button"),this.footerDel.setAttribute("style","border-radius: 18px;margin-right: 20px;color:#e01a1a;border:none;padding: 3px 8px 6px;font-size: 13px;font-weight: 600;background: rgba(239, 26, 26, 0.08);cursor: pointer;"),this.footerDel.innerHTML='<svg class="icon" style="width: 17px; height: 17px;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="689"><path d="M800.162002 316.659033c1.850138-17.575284 17.596773-30.322609 35.172058-28.473495 17.575284 1.850138 30.322609 17.596773 28.473494 35.172058l-57.966202 550.673811c-5.143137 48.856731-46.341445 85.946464-95.467306 85.946464H313.625954c-49.126884 0-90.325192-37.089733-95.468329-85.946464L160.192446 323.358619c-1.850138-17.575284 10.898211-33.32192 28.472471-35.172057 17.575284-1.850138 33.32192 10.898211 35.172058 28.473494l57.965179 550.672788c1.714038 16.285918 15.446807 28.64848 31.822776 28.648481h396.74707c16.375969 0 30.108738-12.363585 31.822776-28.648481l57.967226-550.673811z m-192.176904 99.345636c17.672498 0 31.998785 14.326287 31.998785 31.998785v223.989447c0 17.672498-14.326287 31.998785-31.998785 31.998785s-31.998785-14.326287-31.998785-31.998785V448.00243c0-17.671475 14.326287-31.997762 31.998785-31.997761z m-191.990662 0c17.672498 0 31.998785 14.326287 31.998785 31.998785v223.989447c0 17.672498-14.326287 31.998785-31.998785 31.998785s-31.998785-14.326287-31.998785-31.998785V448.00243c0-17.671475 14.326287-31.997762 31.998785-31.997761z m-31.998785-223.989447h255.987209v-47.998178c0-8.836249-7.163143-15.999392-15.999393-15.999392H399.995043c-8.836249 0-15.999392 7.163143-15.999392 15.999392v47.998178z m-63.996546 0V128.018675c0-35.344996 28.652574-63.996546 63.997569-63.996546h255.987209c35.343973 0 63.996546 28.652574 63.996546 63.996546v63.996547h223.99968c17.672498 0 31.998785 14.326287 31.998785 31.998785s-14.326287 31.998785-31.998785 31.998784H96.019891c-17.672498 0-31.998785-14.326287-31.998785-31.998784s14.326287-31.998785 31.998785-31.998785h223.979214z" p-id="690"></path></svg>',this.footerTag=document.createElement("button"),this.footerTag.setAttribute("style","border-radius: 18px;margin-right: 20px;color:#ebeb18;border:none;padding: 3px 8px 6px;font-size: 13px;font-weight: 600;background: rgba(229, 229, 109, 0.1);cursor: pointer;"),this.footerTag.innerHTML='<svg class="icon" style="width: 18px; height: 18px;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2298"><path d="M512 64.021106c-11.816117 0-23.63121 6.791683-28.127617 20.375049l-97.82705 295.566646H93.719498c-27.710109 0-40.267099 34.785248-18.987446 52.612265L304.048831 624.711038l-82.039481 297.444413c-5.655813 20.513196 10.561543 37.82242 28.662806 37.82242 5.698792 0 11.585873-1.717108 17.030885-5.588275l244.296959-173.672458L756.301052 954.389596c5.445012 3.873214 11.335163 5.588275 17.030885 5.588275 18.10024 0 34.31862-17.310248 28.65462-37.82242L719.951169 624.712061l229.316779-192.135972c21.280676-17.827017 8.725732-52.612265-18.991539-52.612264H637.954667L540.127617 84.396155c-4.496407-13.583366-16.311501-20.37505-28.127617-20.375049z" p-id="2299"></path></svg>',this.footerRestore=document.createElement("button"),this.footerRestore.setAttribute("style","border-radius: 6px;flex: 1 1;color:#1aba9c;border:none;padding: 3px 15px;font-size: 13px;font-weight: 600;background: rgba(26, 186, 156, 0.08);cursor: pointer;"),this.footerRestore.innerHTML="恢复",this.mainFooter.appendChild(this.footerDel),this.mainFooter.appendChild(this.footerTag),this.mainFooter.appendChild(this.footerRestore),r.appendChild(this.mainArticle),r.appendChild(this.mainFooter),this.root.appendChild(o),this.root.appendChild(i),this.root.appendChild(r),e.container.appendChild(this.root),e.container.appendChild(this.maskLayer)}return e.prototype.open=function(){this.root.style.display="flex",this.maskLayer.style.display="inline",this.art_articles=JSON.parse(localStorage.art_articles),document.body.style.overflow="hidden",this.updateDirectory()},e.prototype.updateDirectory=function(){this.sideDraftHistoryDirectory.innerHTML="";for(var e=0,t=Object.keys(this.art_articles).reverse();e<t.length;e++){var o=t[e],i=document.createElement("div");i.style.height="60px",i.style.padding="10px 20px 0",i.style.cursor="pointer";var n=new Date(1*parseInt(this.art_articles[o].time)).toLocaleString().replace(/\//g,"-").substring(0,16);i.innerHTML='<div style="font-weight: 500;">'+n+'</div><div style="font-size: 12px;">当前草稿</div>',i.onclick=this.openMd(this,this.art_articles[o]),this.sideDraftHistoryDirectory.appendChild(i)}this.mainArticle.childNodes[0].innerHTML="",this.mainFooter.style.display="none"},e.prototype.openMd=function(e,t){var o=localStorage[t.ids[0]];return function(){for(var i=e.sideDraftHistoryDirectory.getElementsByClassName("art-VersionHistory-selected"),n=i.length-1;n>=0;n--){var s=i[n].getAttribute("class");s=s.replace("art-VersionHistory-selected",""),i[n].setAttribute("class",s)}this.setAttribute("class","art-VersionHistory-selected"),e.mainArticle.childNodes[0].innerHTML=o,e.mainFooter.style.display="inherit",e.footerDel.onclick=function(){localStorage.removeItem(t.ids[0]),delete e.art_articles[t.name],e.updateDirectory(),L.message(t.name+"已删除","success")},e.footerRestore.onclick=function(){e.artText.editor.openFile(o,t.name),L.message(t.name+"已恢复","success"),e.close()}}},e.prototype.close=function(){localStorage.art_articles=JSON.stringify(this.art_articles),this.maskLayer.style.display="none",this.root.style.display="none",document.body.style.overflow="auto"},e}(),D=function(){function e(t,o){this.artText=t,this.container=o,this.versionHistory=new M(t),this.toolbar=null,this.floatAuxiliaryTool=null,this.floatToolbar=null,this.mdHtml=null,e.message=function(e,o){void 0===o&&(o="null"),E(t,e,o)}}return e.prototype.init=function(){var t,o;this.toolbar=(t=this.artText.config.theme,(o=document.createElement("div")).style.marginBottom="25px",o.style.padding="10px 12px",o.style.boxShadow="0 2px 12px 0 rgba(0, 0, 0, 0.1)",o.style.backgroundColor=t.get("backgroundColor"),o.setAttribute("class","art-toolbar"),L.addCss(".art-toolbar{color: #666; font-weight:600; font-size:13.5px; border-radius: 4px; position: relative;}"),o),this.container.insertBefore(this.toolbar,this.container.childNodes[0]),this.floatAuxiliaryTool=function(){var e=document.createElement("div");e.style.width="200px",e.style.position="absolute",e.style.top="10px",e.style.left="10px",e.style.boxShadow="0 2px 12px 0 rgba(0, 0, 0, 0.1)",e.style.transition="all .15s cubic-bezier(0,0,.2,1)",e.style.border="1px solid #d1d1d1",e.style.borderRadius="2px",e.style.display="none";var t=document.createElement("ul");t.setAttribute("style","list-style:none;margin:0;padding:4px 0;font-size: 13px;font-weight: 500;");var o=document.createElement("li");o.setAttribute("class","art-floatAuxiliaryTool-li"),o.setAttribute("style","padding: 3px 20px;margin:3px 0; cursor: pointer;"),o.innerHTML="使用百度搜索",o.onmousedown=n(u),t.appendChild(o);var i=document.createElement("hr");function n(t){return function(o){t(o,e)}}return i.style.height="0",i.style.marginBottom="0",t.appendChild(i),(o=document.createElement("li")).setAttribute("class","art-floatAuxiliaryTool-li"),o.setAttribute("style","padding: 3px 20px;margin:3px 0; cursor: pointer;"),o.innerText="剪切",o.onmousedown=n(f),t.appendChild(o),(o=document.createElement("li")).setAttribute("class","art-floatAuxiliaryTool-li"),o.setAttribute("style","padding: 3px 20px;margin:3px 0; cursor: pointer;"),o.innerText="复制",o.onmousedown=n(p),t.appendChild(o),(o=document.createElement("li")).setAttribute("class","art-floatAuxiliaryTool-li"),o.setAttribute("style","padding: 3px 20px;margin:3px 0; cursor: pointer;"),o.innerText="粘贴",o.onmousedown=n(g),t.appendChild(o),e.appendChild(t),e}(),this.floatAuxiliaryTool.style.backgroundColor=this.artText.config.theme.get("backgroundColor");var i=".art-floatAuxiliaryTool-li:hover{background-color: #f0f0f0;color:"+this.artText.config.theme.get("color")+"}";this.container.appendChild(this.floatAuxiliaryTool),this.floatToolbar=k(this.artText),this.floatToolbar.style.backgroundColor=this.artText.config.theme.get("backgroundColor");var n=".art-floatToolbar-span{padding: 8px 10px;cursor: pointer;}.art-floatToolbar-span:hover{color:"+this.artText.config.theme.get("color")+"}";this.container.appendChild(this.floatToolbar),this.addDefaultTool();e.addCss(A+".art-toolbar-span{padding:5px 5px;margin-right: 9px} .art-toolbar-span:hover{color:#1abc9c;}"+n+i)},e.prototype.setFloatAuxiliaryTool=function(e){if(void 0===e&&(e="hidden"),"hidden"==e)return this.floatAuxiliaryTool.style.display="none",!1;this.floatAuxiliaryTool.style.display="inline",this.floatAuxiliaryTool.style.top=event.pageY.toString()+"px",this.floatAuxiliaryTool.style.left=event.pageX.toString()+"px"},e.prototype.setFloatToolbar=function(e){if(void 0===e&&(e="hidden"),"hidden"==e)return this.floatToolbar.style.display="none",!1;this.floatToolbar.style.display="inline";var t=event.pageX-this.artText.eventCenter.clickInfo.pageX,o=event.pageY-this.artText.eventCenter.clickInfo.pageY;if(console.log(t,o),o>0){var i=this.artText.eventCenter.clickInfo;this.floatToolbar.style.top=(i.pageY-i.offsetY-20).toString()+"px",this.floatToolbar.style.left=(i.pageX+t/2).toString()+"px"}else this.floatToolbar.style.top=(event.pageY-event.offsetY-20).toString()+"px",this.floatToolbar.style.left=(event.pageX+t/2).toString()+"px"},e.prototype.addDefaultTool=function(){var e=this;this.mdHtml=this.addTool("md",(function(){"md"==e.mdHtml.innerHTML?(e.mdHtml.innerHTML="html",e.artText.editor.openTextarea()):(e.mdHtml.innerHTML="md",e.artText.editor.closeTextarea())})),this.addTool("历史",(function(){e.versionHistory.open()})),this.addTool("保存",(function(){var t=JSON.parse(localStorage.art_articles);if(e.artText.editor.mdFileName&&t.hasOwnProperty(e.artText.editor.mdFileName));else{var o=(new Date).getTime(),i="art_md_"+o+"_";e.artText.editor.mdFileName&&(i+=e.artText.editor.mdFileName),localStorage[i]=e.artText.editor.getMd(),t[i]={ids:[i],time:o,name:i},localStorage.art_articles=JSON.stringify(t)}E(e.artText,"md保存成功","success")})),this.addTool("清空",(function(){e.artText.editor.emptyEditor(),E(e.artText,"清空成功","success")})),this.addTool('<span style="position: absolute;right: 12px;color:#1abc9c" >ATTB</span>',(function(){E(e.artText,"点击了一下")}),!1)},e.prototype.addTool=function(e,t,o){void 0===o&&(o=!0);var i=document.createElement("span");return o&&i.setAttribute("class","art-toolbar-span"),i.style.cursor="pointer",i.innerHTML=e,i.addEventListener("click",t),this.toolbar.appendChild(i),i},e.loadScript=m,e.loadCss=N,e.addCss=y,e.hasClass=v,e.message=null,e}(),A=".art-VersionHistory-selected{color: #1aba9c}\n.art-toc{border: 1px dashed #999;padding: 6px 15px;margin: 35px 0 15px;font-weight:500;}.art-toc p{margin-bottom: 2px}.art-toc a{border-bottom: none;color: #4183c4}.art-toc-h2{margin-left:2em}.art-toc-h3{margin-left:4em}.art-toc-h4{margin-left:6em}.art-toc-h5{margin-left:8em}.art-toc-h6{margin-left:10em}\n.art-flowTool{width:100%;text-align: center;}",L=D,_=function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var i=Array(e),n=0;for(t=0;t<o;t++)for(var s=arguments[t],r=0,l=s.length;r<l;r++,n++)i[n]=s[r];return i},O=function(){function e(e,t,o){void 0===t&&(t={}),void 0===o&&(o=null),this.nodeName=e,this.attr=t,this.childNodes=o instanceof Array?o:null==o?[]:[o]}return e.prototype.newDom=function(){var e,t=document.createElement(this.nodeName);for(var o in this.attr)"__dom__"===o?"tableTool"===this.attr[o]?t.appendChild(n()):"imgTool"===this.attr[o]?t.appendChild((e=void 0,(e=document.createElement("span")).style.fontSize="14px",e.setAttribute("contenteditable","false"),e.innerHTML='<svg class="icon" style="width: 19px; height: 19px;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1140"><path d="M288.010553 448.00243c-35.344996 0-63.996546-28.652574-63.996546-63.996546s28.652574-63.996546 63.996546-63.996546c35.344996 0 63.996546 28.652574 63.996546 63.996546s-28.65155 63.996546-63.996546 63.996546z m639.969556 302.169018l-258.988565-258.077823L372.528482 759.740384c-12.629645 11.402701-31.975249 10.92584-44.027749-1.084705L220.383316 650.927119l-124.363425 100.357686v80.699973c0 17.672498 14.326287 31.998785 31.998784 31.998785h767.96265c17.672498 0 31.998785-14.326287 31.998784-31.998785v-81.81333z m0-90.346681V192.015222c0-17.672498-14.326287-31.998785-31.998784-31.998785H128.018675c-17.672498 0-31.998785 14.326287-31.998784 31.998785v477.033627l84.173074-67.926042c25.424042-20.516266 62.219063-18.58938 85.361133 4.469801l86.61673 86.306668 273.934976-247.308549c25.261337-22.805402 63.951521-21.851681 88.058569 2.170433l213.815736 213.063607zM32.023344 736.273926a45.762253 45.762253 0 0 1 0-0.530072V192.015222c0-53.016471 42.97886-95.995331 95.995331-95.995331h767.96265c53.016471 0 95.995331 42.97886 95.995331 95.995331v639.969556c0 53.016471-42.97886 95.995331-95.995331 95.995331H128.018675c-53.016471 0-95.995331-42.97886-95.995331-95.995331v-95.710852z" p-id="1141"></path></svg>',e.style.cursor="pointer",e.onclick=a,e)):"codeTool"===this.attr[o]&&t.appendChild(d()):"art-math"==o?G.katex?(t.innerHTML=G.katex.renderToString(this.attr["art-math"],{throwOnError:!1}),t.setAttribute(o,this.attr[o])):t.setAttribute(o,"\n@math:katex未加载出@\n"):/^__[a-zA-Z\d]+__$/.test(o)||t.setAttribute(o,this.attr[o]);return this.childNodes.forEach((function(e){t.appendChild(e.newDom())})),t},e.prototype.render=function(e){if(e.nodeName.toLowerCase()==this.nodeName){if("code"==this.nodeName)return null;if(L.hasClass(e,"art-shield")){if(L.hasClass(e,"art-flowTool")&&G.flowchart&&G.Raphael){e.innerHTML="";var t=e.previousSibling.innerText;try{G.flowchart.parse(t).drawSVG(e),e.previousSibling.style.display="none",e.onclick=function(){L.hasClass(this,"art-flowTool")&&(this.previousSibling.style.display="inherit")}}catch(e){console.error("flowchart发生错误"),console.error(e)}}else if("math"==this.attr.__dom__&&G.katex){var o=e.childNodes[0].getAttribute("art-math");o&&this.childNodes[0].attr["art-math"]!=o&&(e.childNodes[0].innerHTML=G.katex.renderToString(this.childNodes[0].attr["art-math"],{throwOnError:!1}),e.childNodes[0].setAttribute("art-math",this.childNodes[0].attr["art-math"]))}else for(var i=0,n=0;i<e.childNodes.length||n<this.childNodes.length;i++,n++)if(i>=e.childNodes.length)e.appendChild(this.childNodes[n].newDom());else if(n>=this.childNodes.length)for(var s=e.childNodes.length;i<s;)e.removeChild(e.lastChild),i++;else this.childNodes[n].render(e.childNodes[i]);for(var r in this.attr)/^__[a-zA-Z\d]+__$/.test(r)||e.setAttribute(r,this.attr[r])}else{for(var r in this.attr)/^__[a-zA-Z\d]+__$/.test(r)||e.setAttribute(r,this.attr[r]);for(i=0,n=0;i<e.childNodes.length||n<this.childNodes.length;i++,n++)if(i>=e.childNodes.length)e.appendChild(this.childNodes[n].newDom());else if(n>=this.childNodes.length)for(s=e.childNodes.length;i<s;)e.removeChild(e.lastChild),i++;else this.childNodes[n].render(e.childNodes[i])}}else e.parentNode.replaceChild(this.newDom(),e);return null},e.domToNode=function(t){if("#text"==t.nodeName)return new i(t.nodeValue);for(var o=new e(t.nodeName.toLowerCase(),{},[]),n=0;n<t.attributes.length;n++){var s=t.attributes[n];o.attr[s.localName]=s.value}for(n=0;n<t.childNodes.length;n++)o.childNodes.push(e.domToNode(t.childNodes[n]));return o},e.prototype.appendChild=function(e){this.childNodes.push(e)},e.prototype.replaceChild=function(e,t){var o=this.childNodes.indexOf(t);-1!=o&&(this.childNodes[o]=e)},e.prototype.getMd=function(e){void 0===e&&(e="editor");var t="";if(/art-toc/.test(this.attr.class))return"[TOC]\n";if("a"==this.nodeName&&this.childNodes.length>0)t+=this.childNodes[0].text;else if("hr"==this.nodeName&&"read"==e)t+="***\n";else if("input"==this.nodeName&&"checkbox"==this.attr.type&&"read"==e)"checked"==this.attr.checked?t+="[x] ":t+="[ ] ";else if("blockquote"==this.nodeName&&"read"==e)for(var o=0;o<this.childNodes.length;o++)t+="> "+this.childNodes[o].getMd(e);else if("ul"==this.nodeName&&"read"==e)for(o=0;o<this.childNodes.length;o++)t+="* "+this.childNodes[o].getMd(e)+"\n";else if("ol"==this.nodeName&&"read"==e)for(o=0;o<this.childNodes.length;o++)t+=(o+1).toString()+". "+this.childNodes[o].getMd(e)+"\n";else if("read"==e&&"li"==this.nodeName){this.childNodes.length>0&&this.childNodes[0];for(o=0;o<this.childNodes.length;o++)t+=this.childNodes[o].getMd(e)}else if("read"==e&&("h1 h2 h3 h4 h5 h6".indexOf(this.nodeName)>=0||"p"==this.nodeName)){for(o=0;o<this.childNodes.length;o++)t+=this.childNodes[o].getMd(e);t+="\n"}else if("read"==e&&"table"==this.nodeName){console.log(this);for(var i=0;i<this.childNodes.length;i++)for(o=0;o<this.childNodes[i].childNodes.length;o++){t+="|";var n=void 0;for(n=0;n<this.childNodes[i].childNodes[o].childNodes.length;n++)t+=this.childNodes[i].childNodes[o].childNodes[n].getMd(e)+"|";if(t+="\n",0==i){for(t+="|";n--;)t+="---|";t+="\n"}}}else if("read"==e&&"pre"==this.nodeName){t+="```";var s=this.childNodes[0].attr.class;s&&(t+=" "+s.substring(5).split(" ")[0]),t+="\n";for(o=0;o<this.childNodes.length;o++)t+=this.childNodes[o].getMd(e);t+="```\n"}else{if(this.attr.class&&"art-shield"==this.attr.class)return"";for(o=0;o<this.childNodes.length;o++)t+=this.childNodes[o].getMd(e)}return t},e.prototype.getText=function(){for(var e="",t=0,o=this.childNodes;t<o.length;t++){var i=o[t];"#text"==i.nodeName?e+=i.getText():null==i.attr.class||/(art\-shield)|(art\-hide)|(art\-show)/.test(i.attr.class)||(e+=i.getText())}return e},e.prototype.dispose=function(){var t;if(1==this.attr.__root__)for(var o=this.childNodes.length-1;o>=0;o--){(s=this.childNodes[o].dispose())&&s.length>0&&(t=this.childNodes).splice.apply(t,_([o,1],s))}else{if(this.attr.class&&this.attr.class.match(/art-shield/))return null;if("blockquote"==this.nodeName)for(o=0;o<this.childNodes.length;o++)"blockquote"==this.childNodes[o].nodeName||"ul"==this.childNodes[o].nodeName||"ol"==this.childNodes[o].nodeName?this.childNodes[o].dispose():/^>\s/.test(this.childNodes[o].getMd())?this.childNodes[o]=new e("blockquote",{},new e("p",{},new e("br"))):/^\*\s/.test(this.childNodes[o].getMd())?this.childNodes[o]=new e("ul",{},new e("li",{},new e("br"))):/^\d\.\s/.test(this.childNodes[o].getMd())?this.childNodes[o]=new e("ol",{},new e("li",{},new e("br"))):this.childNodes[o].childNodes=V(this.childNodes[o].getMd());else if("ul"===this.nodeName||"ol"===this.nodeName)for(o=0;o<this.childNodes.length;o++)if("blockquote"==this.childNodes[o].childNodes[0].nodeName||"ul"==this.childNodes[o].childNodes[0].nodeName||"ol"==this.childNodes[o].childNodes[0].nodeName)for(var i=0;i<this.childNodes[o].childNodes.length;i++)"p"==this.childNodes[o].childNodes[i].nodeName?this.childNodes[o].childNodes[i].childNodes=V(this.childNodes[o].childNodes[i].getMd()):this.childNodes[o].childNodes[i].dispose();else/^>\s/.test(this.childNodes[o].getMd())?this.childNodes[o].childNodes=[new e("blockquote",{},new e("p",{},new e("br")))]:/^\*\s/.test(this.childNodes[o].getMd())?this.childNodes[o].childNodes=[new e("ul",{},new e("li",{},new e("br")))]:/^\d\.\s/.test(this.childNodes[o].getMd())?this.childNodes[o].childNodes=[new e("ol",{},new e("li",{},new e("br")))]:"input"==this.childNodes[o].childNodes[0].nodeName?this.childNodes[o].childNodes=_([this.childNodes[o].childNodes[0]],V(this.childNodes[o].getMd())):/^\[x|X\]\s/.test(this.childNodes[o].getMd())?this.childNodes[o].childNodes=_([new e("input",{type:"checkbox",checked:"checked"})],V(this.childNodes[o].getMd().substring(4))):/^\[\s\]\s/.test(this.childNodes[o].getMd())?this.childNodes[o].childNodes=_([new e("input",{type:"checkbox"})],V(this.childNodes[o].getMd().substring(4))):this.childNodes[o].childNodes=V(this.childNodes[o].getMd());else{if("table"!=this.nodeName)return"pre"===this.nodeName||"hr"==this.nodeName?null:(s=c(this.getMd()))||[new e("p",{},V(this.getMd()))];for(o=0;o<this.childNodes.length;o++)for(i=0;i<this.childNodes[o].childNodes.length;i++)for(var n=0;n<this.childNodes[o].childNodes[i].childNodes.length;n++){var s=V(this.childNodes[o].childNodes[i].childNodes[n].getMd());this.childNodes[o].childNodes[i].childNodes[n].childNodes=s}}}return null},e}(),j=function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var i=Array(e),n=0;for(t=0;t<o;t++)for(var s=arguments[t],r=0,l=s.length;r<l;r++,n++)i[n]=s[r];return i},z=[{tag:"bi",left:"***",right:"***",re:/(\*{3})([^\*].*?)(\*{3})/,fun:function(e){var t=new O("span",{class:"art-hide"},new i("***")),o=new O("span",{class:"art-text-double"},new i(e.substring(3,e.length-3))),n=new O("span",{class:"art-hide"},new i("***"));return[new O("i",{},new O("b",{},[t,o,n]))]}},{tag:"b",left:"**",right:"**",re:/(\*{2})([^\*].*?)(\*{2})/,fun:function(e){return R(["**",2,e,"**","b"])}},{tag:"mark",left:"==",right:"==",re:/\={2}[^\=].*?\={2}/,fun:function(e){return R(["==",2,e,"==","mark"])}},{tag:"code",left:"`",right:"`",re:/`[^`]+`/,fun:function(e){return R(["`",1,e,"`","code"])}},{tag:"i",left:"*",right:"*",re:/(\*)([^\*].*?)(\*)/,fun:function(e){return R(["*",1,e,"*","i"])}},{tag:"img",left:"![",centre:"](",right:")",re:/!\[.*?\]\(.*?\)/,fun:function(e){var t=e.match(/\(.*\)/)[0],o=e.match(/\[.*\]/)[0],n=new O("span",{class:"art-hide"},[new O("span",{class:"art-shield",__dom__:"imgTool"},[]),new i(e)]),s=new O("img",{src:t.substring(1,t.length-1),alt:o.substring(1,o.length-1),contenteditable:"false",style:"margin: 0 auto;display: block;"},null);return[n,s]}},{tag:"a",left:"[",centre:"](",right:")",re:/\[.*?\]\(.*?\)/,fun:function(e){var t=e.match(/\(.*\)/)[0],o=e.match(/\[.*\]/)[0],n=new O("span",{class:"art-hide"},new i("[")),s=new O("a",{href:t.substring(1,t.length-1),class:"art-text-double",title:"alt+点击",style:"cursor: pointer;"},new i(o.substring(1,o.length-1))),r=new O("span",{class:"art-hide"},new i("]"+t));return[n,s,r]}},{tag:"math",left:"$",right:"$",re:/\$.*?\$/,fun:function(e){if(G.katex){var t=new O("span",{class:"art-hide art-math"},new i(e));return[new O("span",{class:"art-shield",style:"position: relative;",contenteditable:"false",__dom__:"math"},new O("span",{style:"top: 35px;display: inline-table;","art-math":e.substring(1,e.length-1)},null)),t]}return[new O("span",{style:"color: #777"},new i(e))]}},{tag:"del",left:"~~",right:"~~",re:/~{2}.*?~{2}/,fun:function(e){return R(["~~",2,e,"~~","del"])}},{tag:"ins",left:"__",right:"__",re:/_{2}.*?_{2}/,fun:function(e){return R(["__",2,e,"__","ins"])}},{tag:"sup",left:"^",right:"^",re:/\^[^\^]+\^/,fun:function(e){return F(["^",1,e,"^","sup"])}},{tag:"sub",left:"~",right:"~",re:/~[^~]+~/,fun:function(e){return F(["~",1,e,"~","sub"])}},{tag:"html_tag",left:"null",right:"null",re:/(<!--[\s\S]*?-->|(<([a-zA-Z]{1}[a-zA-Z\d-]*) *[^\n<>]* *(?:\/)?>)(?:([\s\S]*?)(<\/\3 *>))?)/,fun:function(e){var t=/\s([a-z]+)="(.*?)"/,o=e.match(/^<([a-zA-Z]+)( .*?)?>([\s\S]*?)<\/\1+>/);if(null==o)return[new i(e)];var n={class:"art-text-double"};if(o[2])for(var s=o[2].match(/\s([a-z]+)="(.*?)"/g),r=0;r<s.length;r++){var l=s[r].match(t);n[l[1]]=l[2]}"art-text-double"!=n.class&&(n.class+=" art-text-double");null==o[2]&&(o[2]="");var a=new O("span",{class:"art-hide"},new i("<"+o[1]+o[2]+">")),d=new O(o[1],n,V(o[3])),h=new O("span",{class:"art-hide"},new i("</"+o[1]+">"));return[a,d,h]}}];function R(e){return[new O("span",{class:"art-hide"},new i(e[0])),new O(e[4],{class:"art-text-double"},V(e[2].substring(e[1],e[2].length-e[1]))),new O("span",{class:"art-hide"},new i(e[3]))]}function F(e){var t=new O("span",{class:"art-hide"},new i(e[0])),o=new O("span",{class:"art-text-double"},V(e[2].substring(e[1],e[2].length-e[1]))),n=new O("span",{class:"art-hide"},new i(e[3]));return[new O(e[4],{},[t,o,n])]}var B=[{first:"#",last:"",re:/^#\s/,fun:function(e){var t=j([new O("span",{class:"art-hide"},new i("# "))],V(e.substring(2))),o=new O("h1",{},t),n=o.getMd();return n=n.replace(/\s/g,"-").replace(/\\|\/|#|\:/g,""),o.childNodes.unshift(new O("a",{class:"art-shield",name:n},null)),[o]}},{first:"##",last:"",re:/^##\s/,fun:function(e){var t=j([new O("span",{class:"art-hide"},new i("## "))],V(e.substring(3))),o=new O("h2",{},t),n=o.getMd();return n=n.replace(/\s/g,"-").replace(/\\|\/|#|\:/g,""),o.childNodes.unshift(new O("a",{class:"art-shield",name:n},null)),[o]}},{first:"###",last:"",re:/^###\s/,fun:function(e){var t=j([new O("span",{class:"art-hide"},new i("### "))],V(e.substring(4))),o=new O("h3",{},t),n=o.getMd();return n=n.replace(/\s/g,"-").replace(/\\|\/|#|\:/g,""),o.childNodes.unshift(new O("a",{class:"art-shield",name:n},null)),[o]}},{first:"####",last:"",re:/^####\s/,fun:function(e){var t=j([new O("span",{class:"art-hide"},new i("#### "))],V(e.substring(5))),o=new O("h4",{},t),n=o.getMd();return n=n.replace(/\s/g,"-").replace(/\\|\/|#|\:/g,""),o.childNodes.unshift(new O("a",{class:"art-shield",name:n},null)),[o]}},{first:"#####",last:"",re:/^#####\s/,fun:function(e){var t=j([new O("span",{class:"art-hide"},new i("##### "))],V(e.substring(6))),o=new O("h5",{},t),n=o.getMd();return n=n.replace(/\s/g,"-").replace(/\\|\/|#|\:/g,""),o.childNodes.unshift(new O("a",{class:"art-shield",name:n},null)),[o]}},{first:"######",last:"",re:/^######\s/,fun:function(e){var t=j([new O("span",{class:"art-hide"},new i("###### "))],V(e.substring(7))),o=new O("h6",{},t),n=o.getMd();return n=n.replace(/\s/g,"-").replace(/\\|\/|#|\:/g,""),o.childNodes.unshift(new O("a",{class:"art-shield",name:n},null)),[o]}}];var I,V=function(e){if(""===e)return[new O("br")];for(var t,o,n=[];e;){o=null;for(var s=0;s<z.length;s++)if(t=e.match(z[s].re)){if(0==t.index){o=[t,z[s]];break}o?o.index>t.index&&(o=[t,z[s]]):o=[t,z[s]]}if(!o){n.push(new i(e));break}0!=o[0].index&&n.push(new i(e.substring(0,o[0].index))),o[1].fun(o[0][0]).forEach((function(e){n.push(e)})),e=e.substring(o[0].index+o[0][0].length)}return n},$=function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var i=Array(e),n=0;for(t=0;t<o;t++)for(var s=arguments[t],r=0,l=s.length;r<l;r++,n++)i[n]=s[r];return i};function P(e,t){var o=2;return"ol"==t&&(o=3),""==e.substring(o)?new O("li",{},new O("br")):"ul"==t&&/^\[x|X\]\s/.test(e.substring(2))?new O("li",{},$([new O("input",{type:"checkbox",checked:"checked"})],V(e.substring(6)))):"ul"==t&&/^\[\s\]\s/.test(e.substring(2))?new O("li",{},$([new O("input",{type:"checkbox"})],V(e.substring(6)))):/^\*\s/.test(e.substring(o))||/^\d\.\s/.test(e.substring(o))?new O("li",{},new O(t,{},P(e.substring(o),t))):/^>\s/.test(e.substring(2))?new O("li",{},new O("blockquote",{},K(e.substring(2)))):new O("li",{},V(e.substring(o)))}function K(e){return""==e.substring(2)?new O("p",{},new O("br")):/^>\s/.test(e.substring(2))?new O("blockquote",{},K(e.substring(2))):/^\*\s/.test(e.substring(2))?new O("ul",{},P(e.substring(2),"ul")):/^\d\.\s/.test(e.substring(2))?new O("ol",{},P(e.substring(2),"ol")):new O("p",{},V(e.substring(2)))}function q(e){for(var t=e.childNodes,o=[],i=0;i<t.length;i++)"blockquote"==t[i].nodeName&&o.length>0&&"blockquote"==o[o.length-1].nodeName||"ul"==t[i].nodeName&&o.length>0&&"ul"==o[o.length-1].nodeName||"ol"==t[i].nodeName&&o.length>0&&"ol"==o[o.length-1].nodeName?o[o.length-1].childNodes.push(t[i].childNodes[0]):"ul"==t[i].childNodes[0].nodeName&&o.length>0&&"ul"==o[o.length-1].childNodes[0].nodeName||"ol"==t[i].childNodes[0].nodeName&&o.length>0&&"ol"==o[o.length-1].childNodes[0].nodeName?o[o.length-1].childNodes[0].childNodes.push(t[i].childNodes[0].childNodes[0]):(o.length>0&&("blockquote"==o[o.length-1].nodeName?o[o.length-1]=q(o[o.length-1]):"ul ol".indexOf(o[o.length-1].childNodes[0].nodeName)>=0?o[o.length-1].childNodes[0]=q(o[o.length-1].childNodes[0]):"ul ol".indexOf(o[o.length-1].nodeName)>=0&&(o[o.length-1]=q(o[o.length-1]))),o.push(t[i]));return o.length>0&&("blockquote"==o[o.length-1].nodeName?o[o.length-1]=q(o[o.length-1]):"ul ol".indexOf(o[o.length-1].childNodes[0].nodeName)>=0?o[o.length-1].childNodes[0]=q(o[o.length-1].childNodes[0]):"ul ol".indexOf(o[o.length-1].nodeName)>=0&&(o[o.length-1]=q(o[o.length-1]))),e.childNodes=o,e}!function(e){e.editor="editor",e.read="read"}(I||(I={}));var X=function(){function e(e){this.renderFlag=!0,this.md="",e.md&&(this.md=e.md),this.runModel=I.editor,e.runModel&&(this.runModel=e.runModel),e.katex?this.katex=e.katex:this.katex={js:"https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.js",css:"https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.css"},e.hljs?this.hljs=e.hljs:this.hljs={js:"https://libs.cdnjs.net/highlight.js/10.1.2/highlight.min.js",css:null},e.flowchart?this.flowchart=e.flowchart:this.flowchart={js:["https://cdnjs.cloudflare.com/ajax/libs/raphael/2.3.0/raphael.min.js","https://cdnjs.cloudflare.com/ajax/libs/flowchart/1.14.0/flowchart.min.js"],css:null},this.theme=new Map([["backgroundColor","#fff"],["color","#1abc9c"]]),null==localStorage.art_config&&(localStorage.art_config=JSON.stringify({articles:"art_articles"}))}return e.RunModel=I,e}();function Y(e){var t=e.target.parentNode.parentNode;t.nextSibling&&L.hasClass(t.nextSibling,"art-toc")&&(t.parentNode.removeChild(t.nextSibling),t.parentNode.removeChild(t))}var U=function(e,t,o,i,n,s,r,l){this.anchorInlineOffset=e,this.focusInlineOffset=t,this.anchorAlineOffset=o,this.focusAlineOffset=i,this.anchorOffset=n,this.anchorNode=s,this.focusNode=l,this.focusOffset=r},J=function(){function e(e){this.editorHtmlDom=e,this.location=null}return e.prototype.getSelection=function(){var t=e.sel,o=t.anchorNode,i=t.anchorOffset,n=t.focusNode,s=t.focusOffset;if(o&&n){var r=o,l=i;if(r==this.editorHtmlDom)return this.location=null,this.location;for(;r.parentNode!=this.editorHtmlDom;){for(;r.previousSibling;)r=r.previousSibling,L.hasClass(r,"art-shield")||(l+=r.textContent.length);r=r.parentNode}for(var a=n,d=s;a.parentNode!==this.editorHtmlDom;){for(;a.previousSibling;)a=a.previousSibling,L.hasClass(a,"art-shield")||(d+=a.textContent.length);a=a.parentNode}for(var h=-1,c=0;c<this.editorHtmlDom.childNodes.length;c++)if(this.editorHtmlDom.childNodes[c]===r){h=c;break}var u=-1;for(c=0;c<this.editorHtmlDom.childNodes.length;c++)if(this.editorHtmlDom.childNodes[c]===a){u=c;break}var p=o.parentNode.nodeName;0!=i||null!=o.previousSibling||"LI"!=p&&"P"!=p&&"TH"!=p&&"TD"!=p||(o=o.parentNode),this.location=new U(l,d,h,u,i,o,s,n)}else this.location=null;return this.location},e.prototype.searchNode=function(e,t){if(1===e.childNodes.length&&"#text"===e.childNodes[0].nodeName)return t<=e.childNodes[0].textContent.length?[e.childNodes[0],t]:[e.childNodes[0],t-e.textContent.length];for(var o=0;o<e.childNodes.length;o++)if(!L.hasClass(e.childNodes[o],"art-shield")){if(!(e.childNodes[o].textContent.length<t))return"#text"===e.childNodes[o].nodeName?[e.childNodes[o],t]:this.searchNode(e.childNodes[o],t);t-=e.childNodes[o].textContent.length}return null},e.prototype.setTool=function(e){for(var t=this.editorHtmlDom.getElementsByClassName("art-tocTool"),o=0;o<t.length;o++)t[o].style.visibility="hidden";if(L.hasClass(e,"art-shield"))return!!L.hasClass(e,"art-toc")&&(e.previousSibling&&L.hasClass(e.previousSibling,"art-tocTool")?e.previousSibling.style.visibility="visible":e.parentNode.insertBefore(function(){var e=document.createElement("div");e.style.width="100%",e.className="art-tocTool art-shield",e.style.fontSize="14px",e.style.position="relative",e.style.top="8px",e.style.height="0",e.setAttribute("contenteditable","false");var t=document.createElement("span");t.style.fontWeight="600",t.innerHTML="目录";var o=document.createElement("span");return o.innerHTML='<svg class="icon" style="width: 18px; height: 18px;color: red;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="689"><path d="M800.162002 316.659033c1.850138-17.575284 17.596773-30.322609 35.172058-28.473495 17.575284 1.850138 30.322609 17.596773 28.473494 35.172058l-57.966202 550.673811c-5.143137 48.856731-46.341445 85.946464-95.467306 85.946464H313.625954c-49.126884 0-90.325192-37.089733-95.468329-85.946464L160.192446 323.358619c-1.850138-17.575284 10.898211-33.32192 28.472471-35.172057 17.575284-1.850138 33.32192 10.898211 35.172058 28.473494l57.965179 550.672788c1.714038 16.285918 15.446807 28.64848 31.822776 28.648481h396.74707c16.375969 0 30.108738-12.363585 31.822776-28.648481l57.967226-550.673811z m-192.176904 99.345636c17.672498 0 31.998785 14.326287 31.998785 31.998785v223.989447c0 17.672498-14.326287 31.998785-31.998785 31.998785s-31.998785-14.326287-31.998785-31.998785V448.00243c0-17.671475 14.326287-31.997762 31.998785-31.997761z m-191.990662 0c17.672498 0 31.998785 14.326287 31.998785 31.998785v223.989447c0 17.672498-14.326287 31.998785-31.998785 31.998785s-31.998785-14.326287-31.998785-31.998785V448.00243c0-17.671475 14.326287-31.997762 31.998785-31.997761z m-31.998785-223.989447h255.987209v-47.998178c0-8.836249-7.163143-15.999392-15.999393-15.999392H399.995043c-8.836249 0-15.999392 7.163143-15.999392 15.999392v47.998178z m-63.996546 0V128.018675c0-35.344996 28.652574-63.996546 63.997569-63.996546h255.987209c35.343973 0 63.996546 28.652574 63.996546 63.996546v63.996547h223.99968c17.672498 0 31.998785 14.326287 31.998785 31.998785s-14.326287 31.998785-31.998785 31.998784H96.019891c-17.672498 0-31.998785-14.326287-31.998785-31.998784s14.326287-31.998785 31.998785-31.998785h223.979214z" p-id="690"></path></svg>',o.title="删除目录",o.style.position="absolute",o.style.right="0",o.style.cursor="pointer",o.onclick=Y,e.appendChild(t),e.appendChild(o),e}(),e),!0);t=this.editorHtmlDom.getElementsByClassName("art-codeTool");for(o=0;o<t.length;o++)t[o].style.visibility="hidden";t=this.editorHtmlDom.getElementsByClassName("art-tableTool");for(o=0;o<t.length;o++)t[o].style.visibility="hidden";t=this.editorHtmlDom.getElementsByClassName("art-flowTool");for(o=0;o<t.length;o++)t[o].style.border="inherit";return"PRE"==e.nodeName?(L.hasClass(e.previousSibling,"art-codeTool")?e.previousSibling.style.visibility="visible":e.parentNode.insertBefore(d(),e),L.hasClass(e,"art-pre-flow")&&(e.style.display="inherit",e.nextSibling.style.border="1px solid #999"),!0):"TABLE"==e.nodeName&&(L.hasClass(e.previousSibling,"art-tableTool")?e.previousSibling.style.visibility="visible":e.parentNode.insertBefore(n(),e),!0)},e.prototype.setSelection=function(t){if(void 0===t&&(t=void 0),null!=typeof t&&t||(t=this.location),!t)return!1;for(var o=this.editorHtmlDom.getElementsByClassName("art-show"),i=o.length-1;i>=0;i--){a=(a=o[i].getAttribute("class")).replace("art-show","art-hide"),o[i].setAttribute("class",a)}if(this.location&&this.location.anchorInlineOffset==this.location.focusInlineOffset&&this.location.anchorAlineOffset==this.location.focusAlineOffset){var n=null,s=this.editorHtmlDom.childNodes[this.location.focusAlineOffset],r=this.location.anchorInlineOffset;if(this.setTool(s),console.log(this.location),n="HR"==s.nodeName?[s,0]:"LI"===this.location.anchorNode.nodeName||"TH"===this.location.anchorNode.nodeName||"P"===this.location.anchorNode.nodeName||"TD"===this.location.anchorNode.nodeName||"DIV"===this.location.anchorNode.nodeName||0==this.location.anchorOffset&&this.location.anchorNode.parentNode&&("CODE"==this.location.anchorNode.parentNode.nodeName&&"PRE"==this.location.anchorNode.parentNode.parentNode.nodeName||"CODE"==this.location.anchorNode.nodeName&&"PRE"==this.location.anchorNode.parentNode.nodeName)?[this.location.anchorNode,0]:this.searchNode(s,r),console.log(n),null===n)return null;var l=this.editorHtmlDom.getElementsByClassName("art-show-math");for(i=l.length-1;i>=0;i--){a=(a=l[i].getAttribute("class")).replace("art-show-math",""),l[i].setAttribute("class",a)}if("#text"==n[0].nodeName&&L.hasClass(n[0].parentNode,"art-math"))(null==(a=n[0].parentNode.previousSibling.childNodes[0].getAttribute("class"))||a.indexOf("art-show-math")<0)&&(a="art-show-math",n[0].parentNode.previousSibling.childNodes[0].setAttribute("class",a));e.setCursor(n[0],n[1]);var a,d=n[0].parentNode;if(d&&L.hasClass(d,"art-hide")&&(d.previousSibling&&L.hasClass(d.previousSibling,"art-text-double")?d=d.previousSibling:d.nextSibling&&L.hasClass(d.nextSibling,"art-text-double")&&(d=d.nextSibling)),d&&L.hasClass(d,"art-text-double"))a=(a=d.nextSibling.getAttribute("class")).replace("art-hide","art-show"),d.nextSibling.setAttribute("class",a),a=(a=d.previousSibling.getAttribute("class")).replace("art-hide","art-show"),d.previousSibling.setAttribute("class",a);if("#text"===n[0].nodeName&&L.hasClass(n[0].parentNode,"art-hide"))a=(a=n[0].parentNode.getAttribute("class")).replace("art-hide","art-show"),n[0].parentNode.setAttribute("class",a)}},e.setCursor=function(t,o){var i=e.sel.getRangeAt(0).cloneRange();i.setStart(t,o),i.collapse(!0),e.sel.removeAllRanges(),e.sel.addRange(i)},e.sel=window.getSelection(),e}(),Z=window,W=function(){function e(t,o){this.artText=t,this.container=o,this.editorHtmlNode=this.createRootNode(),this.cursor=new J(this.editorHtmlDom),this.mdFileName=null,this.directory=[],e.artTexts.push(t)}return e.updataArtTextRender=function(){for(var t=0,o=e.artTexts;t<o.length;t++){o[t].editor.render()}},Object.defineProperty(e,"hljs",{get:function(){return e._hljs},set:function(t){e._hljs=t,e.updataArtTextRender()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"katex",{get:function(){return e._katex},set:function(t){e._katex=t,e.updataArtTextRender()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"flowchart",{get:function(){return e._flowchart},set:function(t){e._flowchart=t,e.updataArtTextRender()},enumerable:!1,configurable:!0}),e.prototype.createRootNode=function(){var e,t=new O("p",{},new O("br"));e=this.artText.config.runModel==X.RunModel.read?"false":"true";var o=new O("div",{__root__:!0,contenteditable:e,class:"art-editor-html"},t);return this.editorDom=document.createElement("div"),this.editorDom.setAttribute("class","art-editor"),this.editorHtmlDom=document.createElement("div"),this.editorHtmlDom.setAttribute("class","art-editor-html"),this.editorMdDom=document.createElement("textarea"),this.editorMdDom.setAttribute("class","art-editor-md"),this.editorDom.appendChild(this.editorHtmlDom),this.editorDom.appendChild(this.editorMdDom),this.container.appendChild(this.editorDom),this.editorHtmlDom.style.outline="none",this.editorHtmlDom.style.whiteSpace="pre-wrap",this.editorHtmlDom.style.wordBreak="break-all",this.editorMdDom.style.width="100%",this.editorMdDom.style.minHeight="200px",this.editorMdDom.style.border="none",this.editorMdDom.style.outline="none",this.editorMdDom.style.resize="none",this.editorMdDom.style.display="none",this.editorMdDom.addEventListener("input",(function(e){e.target.style.height=this.scrollHeight+"px"})),this.editorDom.style.boxShadow="0 2px 12px 0 rgba(0, 0, 0, 0.1)",this.editorDom.style.padding="30px 25px",this.editorDom.style.backgroundColor=this.artText.config.theme.get("backgroundColor"),this.editorDom.style.borderRadius="4px",o},e.prototype.closure=function(e){var t=this;return function(o){e(o,t)}},e.prototype.init=function(){L.addCss(Q),this.artText.config.hljs.jsFun?e.hljs=this.artText.config.hljs.jsFun:this.artText.config.hljs.js&&L.loadScript(this.artText.config.hljs.js,(function(){e.hljs=Z.hljs,e.hljs.initHighlighting.called=!1,e.hljs.initHighlighting()})),this.artText.config.katex.jsFun?e.katex=this.artText.config.katex.jsFun:this.artText.config.katex.js&&L.loadScript(this.artText.config.katex.js,(function(){e.katex=Z.katex})),this.artText.config.katex.cssFun||this.artText.config.katex.css&&L.loadCss(this.artText.config.katex.css),this.artText.config.flowchart.jsFun?e.flowchart=this.artText.config.flowchart.jsFun:this.artText.config.flowchart.js&&(L.loadScript(this.artText.config.flowchart.js[0],(function(){e.Raphael=Z.Raphael})),L.loadScript(this.artText.config.flowchart.js[1],(function(){e.flowchart=Z.flowchart}))),this.setMd(this.artText.config.md)},e.prototype.click=function(e){void 0===e&&(e="left"),this.cursor.getSelection(),"right"==e?this.artText.tool.setFloatAuxiliaryTool("bu"):(this.cursor.location&&this.cursor.location.anchorInlineOffset!=this.cursor.location.focusInlineOffset&&this.cursor.location.anchorAlineOffset==this.cursor.location.focusAlineOffset?this.artText.tool.setFloatToolbar("bu"):this.artText.tool.setFloatToolbar(),this.artText.tool.setFloatAuxiliaryTool()),this.cursor.setSelection()},e.prototype.backRender=function(){var e=this.cursor.getSelection();if(e)if("PRE"==this.editorHtmlDom.childNodes[e.anchorAlineOffset].nodeName){if(null==e.anchorNode.previousSibling&&0==e.anchorInlineOffset)return!1}else console.log("无执行",e);return!0},e.prototype.enterRender=function(){var e=this.cursor.getSelection();if(e){var t=O.domToNode(this.editorHtmlDom);this.editorHtmlNode.childNodes=t.childNodes;var o=this.editorHtmlNode.childNodes[e.anchorAlineOffset].getMd(),i=this.editorHtmlDom.childNodes[e.anchorAlineOffset];if(/^(\*{3,}$|^\-{3,}$|^\_{3,}$)/.test(o)){var n=document.createElement("hr");return this.editorHtmlDom.replaceChild(n,i),J.setCursor(n,0),!1}if(/^\[(TOC)|(toc)\]$/.test(o))return(m=document.createElement("div")).setAttribute("class","art-shield art-toc"),m.setAttribute("contenteditable","false"),(b=document.createElement("p")).innerHTML="<br/>",i.nextSibling?i.parentNode.insertBefore(b,i.nextSibling):i.parentNode.appendChild(b),this.editorHtmlDom.replaceChild(m,i),this.updateToc(),J.setCursor(b,0),!1;if(/^\|.*\|/.test(o)){var s=document.createElement("table"),r=document.createElement("thead"),l=document.createElement("tbody");s.appendChild(r),s.appendChild(l),s.style.width="100%",s.style.marginTop="35px";for(var a=document.createElement("tr"),d=document.createElement("tr"),h=o.split("|"),c=1,u=h.length-1;c<u;c++){var p=document.createElement("th");p.innerHTML=h[c],a.appendChild(p),d.appendChild(document.createElement("td"))}return r.appendChild(a),l.appendChild(d),this.editorHtmlDom.replaceChild(s,this.editorHtmlDom.childNodes[e.anchorAlineOffset]),J.setCursor(d.childNodes[0],0),!1}if(/^```/.test(o)){var f=document.createElement("pre"),g=document.createElement("code");g.innerHTML="\n";var m,N=o.match(/^```\s*([^\s]*?)\s*$/)[1];if(null!=N&&""!=N)if(g.setAttribute("class","lang-"+N),f.setAttribute("class","art-pre-"+N),"flow"==N)(m=document.createElement("div")).setAttribute("class","art-shield art-flowTool"),m.setAttribute("art-flow",""),m.setAttribute("contenteditable","false"),this.editorHtmlDom.insertBefore(m,this.editorHtmlDom.childNodes[e.anchorAlineOffset].nextSibling);return f.appendChild(g),this.editorHtmlDom.replaceChild(f,this.editorHtmlDom.childNodes[e.anchorAlineOffset]),J.setCursor(g,0),!1}if("BLOCKQUOTE"==e.anchorNode.parentNode.nodeName&&0==e.anchorOffset&&"P"==e.anchorNode.nodeName&&1==e.anchorNode.childNodes.length&&"BR"==e.anchorNode.childNodes[0].nodeName){var y=e.anchorNode;return(b=document.createElement("p")).innerHTML="<br/>",y.parentNode.nextSibling?y.parentNode.parentNode.insertBefore(b,y.parentNode.nextSibling):y.parentNode.parentNode.appendChild(b),y.parentNode.removeChild(y),J.setCursor(b,0),!1}if("BLOCKQUOTE"==e.anchorNode.parentNode.parentNode.nodeName&&null==e.anchorNode.nextSibling&&e.anchorOffset==e.anchorNode.length){var v=e.anchorNode;return(b=document.createElement("p")).innerHTML="<br/>",v.parentNode.nextSibling?v.parentNode.parentNode.insertBefore(b,v.parentNode.nextSibling):v.parentNode.parentNode.appendChild(b),J.setCursor(b,0),!1}if(0==e.anchorOffset&&"LI"==e.anchorNode.nodeName&&1==e.anchorNode.childNodes.length&&"BR"==e.anchorNode.childNodes[0].nodeName){var x=e.anchorNode;return(b=document.createElement("p")).innerHTML="<br/>",x.parentNode.nextSibling?x.parentNode.parentNode.insertBefore(b,x.parentNode.nextSibling):x.parentNode.parentNode.appendChild(b),x.parentNode.removeChild(x),J.setCursor(b,0),!1}if("P"==e.anchorNode.parentNode.nodeName&&"LI"==e.anchorNode.parentNode.parentNode.nodeName){var b,w=e.anchorNode;return(b=document.createElement("p")).innerHTML="<br/>",w.parentNode.nextSibling?w.parentNode.parentNode.insertBefore(b,w.parentNode.nextSibling):w.parentNode.parentNode.appendChild(b),J.setCursor(b,0),!1}if("P"==e.anchorNode.nodeName&&"LI"==e.anchorNode.parentNode.nodeName&&1==e.anchorNode.childNodes.length&&"BR"==e.anchorNode.childNodes[0].nodeName){var T=e.anchorNode,C=document.createElement("li");return C.innerHTML="<br/>",T.parentNode.nextSibling?T.parentNode.parentNode.insertBefore(C,T.parentNode.nextSibling):T.parentNode.parentNode.appendChild(C),T.parentNode.removeChild(T),J.setCursor(C,0),!1}if("PRE"==i.nodeName){var H=e.anchorNode.nodeValue;return console.log(H),H=H.substring(0,e.anchorOffset)+"\n\r"+H.substring(e.anchorOffset),e.anchorNode.nodeValue=H,J.setCursor(e.anchorNode,e.anchorOffset+1),!1}console.log("无执行",e)}return!0},e.prototype.getDirectory=function(){this.directory=[];for(var e=0;e<this.editorHtmlNode.childNodes.length;e++)/^h\d$/.test(this.editorHtmlNode.childNodes[e].nodeName)&&this.directory.push(this.editorHtmlNode.childNodes[e]);return this.directory},e.prototype.render=function(){this.cursor.getSelection(),console.log(this.cursor.location);var t=O.domToNode(this.editorHtmlDom);this.editorHtmlNode.childNodes=t.childNodes,this.editorHtmlNode.dispose(),this.updateToc(),this.artText.config.renderFlag&&(this.editorHtmlNode.render(this.editorHtmlDom),e.hljs&&this.cursor.location&&"PRE"==this.editorHtmlDom.childNodes[this.cursor.location.anchorAlineOffset].nodeName&&(e.hljs.initHighlighting.called=!1,e.hljs.initHighlighting())),this.cursor.setSelection()},e.prototype.updateToc=function(){for(var e=[],t=[],o=0,n=this.editorHtmlNode.childNodes;o<n.length;o++){var s=n[o];if(/^h\d$/.test(s.nodeName)){var r=s.getMd();r=r.replace(/\s/g,"-").replace(/\\|\/|#|\:/g,"");var l=new O("a",{href:"#"+r},new i(s.getText())),a=new O("p",{class:"art-toc-"+s.nodeName},l);t.push(a)}else"VNode"==s.constructor.name&&s.attr.class&&/art-toc/.test(s.attr.class)&&e.push(s)}for(var d=0,h=e;d<h.length;d++){h[d].childNodes=t}console.log(e,t)},e.prototype.getMd=function(){for(var e="",t=0;t<this.editorHtmlNode.childNodes.length;t++)e+=this.editorHtmlNode.childNodes[t].getMd("read")+"\n";return e},e.prototype.setMd=function(t){var o=function(e){if(null==e)return null;for(var t,o=e.split("\n"),n=[],s=0,r=o.length;s<r;s++)if(/^>\s/.test(o[s])){for(t=[];s<r&&/^>\s/.test(o[s]);)t.push(K(o[s])),s++;s<r&&/^\s*$/.test(o[s+1])||s--,n.push(q(new O("blockquote",{},t)))}else if(/^\*\s/.test(o[s])){for(t=[];s<r&&/^\*\s/.test(o[s]);)t.push(P(o[s],"ul")),s++;s<r&&/^\s*$/.test(o[s+1])||s--,n.push(q(new O("ul",{},t)))}else if(/^\d\.\s/.test(o[s])){for(t=[];s<r&&/^\d\.\s/.test(o[s]);)t.push(P(o[s],"ol")),s++;s<r&&/^\s*$/.test(o[s+1])||s--,n.push(q(new O("ol",{},t)))}else if(/^```/.test(o[s])){var l=o[s].match(/^```\s*([^\s]*?)\s*$/)[1],a=void 0,d=!1,h="";for(a=s+1;a<r;a++){if(/^```$/.test(o[a])){d=!0;break}h+=o[a]+"\n"}if(d){s=a;var u=void 0;null!=l&&""!=l?(u=new O("code",{class:"lang-"+l},new i(h)),n.push(new O("pre",{style:"margin-top:35px",class:"art-pre-"+l},u)),"flow"==l&&n.push(new O("div",{class:"art-shield art-flowTool",contenteditable:"false"},[]))):(u=new O("code",{},new i(h)),n.push(new O("pre",{style:"margin-top:35px"},u))),s+1<r&&/^\s*$/.test(o[s+1])&&s++}else n.push(new O("p",{},new i(o[s]))),s+1<r&&""==o[s+1]&&s++}else if(/^\|.*\|/.test(o[s])){var p=void 0,f=(a=void 0,void 0),g=[],m=void 0;if(s+1<r&&/^\|(\s*-{3,}\s*\|)+/.test(o[s+1])){for(t=[],a=1,f=(p=o[s].split("|")).length-1;a<f;a++)g.push(new O("th",{},V(p[a])));for(t.push(new O("thead",{},new O("tr",{},g))),s+=2,m=[];s<r&&/^\|.*\|/.test(o[s]);){for(g=[],a=1,f=(p=o[s].split("|")).length-1;a<f;a++)g.push(new O("td",{},V(p[a])));m.push(new O("tr",{},g)),s++}s<r&&/^\s*$/.test(o[s+1])||s--,t.push(new O("tbody",{},m)),n.push(new O("table",{style:"width:100%; margin-top:35px"},t))}else n.push(new O("p",{},V(o[s]))),s+1<r&&/^\s*$/.test(o[s+1])&&s++}else/^(\*{3,}$|^\-{3,}$|^\_{3,}$)/.test(o[s])?(n.push(new O("hr")),s+1<r&&/^\s*$/.test(o[s+1])&&s++):/^\[(TOC)|(toc)\]$/.test(o[s])?(n.push(new O("div",{class:"art-shield art-toc",contenteditable:"false",__dom__:"toc"})),s+1<r&&/^\s*$/.test(o[s+1])&&s++):(t=c(o[s]))?(t.forEach((function(e){n.push(e)})),s+1<r&&/^\s*$/.test(o[s+1])&&s++):(n.push(new O("p",{},V(o[s]))),s+1<r&&/^\s*$/.test(o[s+1])&&s++);return n}(t);o&&(this.editorHtmlNode.childNodes=o),this.updateToc(),this.editorHtmlNode.render(this.editorHtmlDom),e.hljs&&(e.hljs.initHighlighting.called=!1,e.hljs.initHighlighting())},e.prototype.openFile=function(e,t){this.mdFileName=t,this.setMd(e)},e.prototype.openTextarea=function(){this.editorHtmlDom.style.display="none",this.editorMdDom.style.display="inline",this.editorMdDom.value=this.getMd(),this.editorMdDom.style.height=this.editorMdDom.scrollHeight+5+"px"},e.prototype.closeTextarea=function(){this.editorHtmlDom.style.display="inline",this.setMd(this.editorMdDom.value),this.editorMdDom.style.display="none"},e.prototype.emptyEditor=function(){"none"==this.editorHtmlDom.style.display?(this.editorMdDom.value="",this.editorMdDom.style.height="auto"):this.setMd("")},e.artTexts=[],e._hljs=null,e._katex=null,e._flowchart=null,e.Raphael=null,e}(),Q="\n.art-hide{display: inline-block;width: 0;height: 0;overflow: hidden;vertical-align: middle;}\n.art-show{color: #ccc;}\n.art-editor-html pre code{white-space: pre-wrap;}\n.art-show-math{position: absolute;padding: 13px 25px;background: #fff;box-shadow: rgba(0, 0, 0, 0.1) 0px 2px 12px 0px;}",G=W,ee=function(){function e(e,t){this.artText=e,this.editorHtmlDom=t,this.uploadImg=null,this.clickInfo=null,this.isComposition=!1,this.futureEvent=new Map}return e.prototype.init=function(){this.addEventListener("keydown",this.keydown),this.addEventListener("keyup",this.keyup),this.addEventListener("compositionstart",(function(e,t){t.isComposition=!0})),this.addEventListener("compositionend",(function(e,t){t.isComposition=!1})),this.addEventListener("click",this.click),this.addEventListener("contextmenu",this.contextmenu),this.addEventListener("mousedown",this.mousedown),this.addEventListener("paste",this.paste),this.addEventListener("drop",this.drop)},e.prototype.addFutureEvent=function(e,t){this.futureEvent.has(e)?this.futureEvent.get(e).push(t):this.futureEvent.set(e,[t])},e.prototype.executeFutureEvent=function(e){if(this.futureEvent.has(e)){for(var t=this.futureEvent.get(e),o=t.length-1;o>=0;o--)t[o]();this.futureEvent.set(e,[])}},e.prototype.addEventListener=function(e,t,o){void 0===o&&(o=!1);var i=this;this.editorHtmlDom.addEventListener(e,(function(e){t(e,i)}),o)},e.prototype.removeEventListener=function(e,t,o){void 0===o&&(o=!1),this.editorHtmlDom.removeEventListener(e,t,o)},e.prototype.keydown=function(e,t){var o=e.keyCode;if(!t.shortcutKey(e,t.artText))return!1;if(13==o){if(!t.artText.editor.enterRender())return e.preventDefault(),!1}else if(8==o&&!t.artText.editor.backRender())return e.preventDefault(),!1;return!0},e.prototype.shortcutKey=function(e,t){if(e.ctrlKey&&66==e.keyCode)x(t);else if(e.ctrlKey&&73==e.keyCode)b(t);else if(e.ctrlKey&&e.shiftKey&&68==e.keyCode)w(t);else if(e.ctrlKey&&85==e.keyCode)T(t);else if(e.ctrlKey&&e.altKey&&83==e.keyCode)C(t);else if(e.ctrlKey&&e.shiftKey&&83==e.keyCode)H(t);else{if(!e.ctrlKey||77!=e.keyCode)return!0;!function(e){S(e,"==")}(t)}return!1},e.prototype.keyup=function(e,t){8==e.keyCode&&""==t.editorHtmlDom.innerHTML&&(t.editorHtmlDom.innerHTML="<div><p><br/></p></div>"),t.isComposition||t.artText.editor.render()},e.prototype.click=function(e,t){var o=e.target;e.altKey&&"A"==o.nodeName?window.open(o.href):t.artText.editor.click("left")},e.prototype.contextmenu=function(e,t){e.preventDefault(),t.artText.editor.click("right")},e.prototype.mousedown=function(e,t){var o=new Map;o.pageX=e.pageX,o.pageY=e.pageY,o.offsetX=e.offsetX,o.offsetY=e.offsetY,t.clickInfo=o},e.prototype.paste=function(e,t){if(e.clipboardData&&e.clipboardData.items){for(var o=null,i=0,n=e.clipboardData.items.length;i<n;i++){var s=e.clipboardData.items[i];if("string"===s.kind)if("text/plain"==s.type)o=["text/plain",s];else if("text/html"==s.type){o=["text/html",s];break}}if(o&&"text/html"==o[0]){var r=t.getAsString(t);return o[1].getAsString(r),!1}}},e.prototype.getAsString=function(e){return function(t){var o=document.createElement("html");o.innerHTML=t;var i=o.childNodes[1],n=e.artText.editor.cursor.location;console.log(n);var s=function e(t){var o="";if("DIV"==t.nodeName||"P"==t.nodeName){for(var i=0;i<t.childNodes.length;i++)o+=e(t.childNodes[i]);o+="\n"}else if("UL"==t.nodeName)for(i=0;i<t.childNodes.length;i++)o+="* "+e(t.childNodes[i])+"\n";else if("OL"==t.nodeName)for(i=0;i<t.childNodes.length;i++)o+=(i+1).toString()+". "+e(t.childNodes[i])+"\n";else if("BLOCKQUOTE"==t.nodeName)for(i=0;i<t.childNodes.length;i++)o+="> "+e(t.childNodes[i])+"\n";else if("TABLE"==t.nodeName)for(i=0;i<t.childNodes.length;i++)o+="> "+e(t.childNodes[i])+"\n";else if(/^H\d$/.test(t.nodeName)){o+="#".repeat(t.nodeName[1])+" ";for(i=0;i<t.childNodes.length;i++)o+=e(t.childNodes[i]);o+="\n"}else if("A"==t.nodeName)o+="["+e(t.childNodes[0])+"]("+t.href+")";else if("IMG"==t.nodeName)o+="!["+t.alt+"]("+t.src+")";else if("#text"==t.nodeName)o+=t.data;else{var n=!0;for(i=0;i<z.length;i++)if(t.nodeName.toLowerCase()==z[i].tag){o+=z[i].left;for(var s=0;s<t.childNodes.length;s++)o+=e(t.childNodes[s]);o+=z[i].right,n=!1;break}for(i=0;n&&i<t.childNodes.length;i++)o+=e(t.childNodes[i])}return o}(i);console.log(s);for(var r=(s=s.replace(/(^\s*)|(\s*$)/g,"")).split("\n"),l=n[2],a=0;a<r.length;a++)0==a?(console.log(l),e.editorHtmlDom.childNodes[l].appendChild(document.createTextNode(r[a])),l++):(console.log(l),e.editorHtmlDom.insertBefore(document.createTextNode(r[a]),e.editorHtmlDom.childNodes[l]),l++)}},e.prototype.drop=function(e,t){e.preventDefault();for(var o=0,i=e.dataTransfer.files.length;o<i;o++){var n=e.dataTransfer.files[o],s=new FileReader;console.log(s,n),/.*\.md$/.test(n.name)||"text/plain"==n.type?(s.onload=function(){s.result&&t.artText.editor.openFile(s.result.toString(),n.name)},s.readAsText(n)):/^image\/(png|jpe?g)$/.test(n.type)?(s.onload=function(){var o=null;o=t.uploadImg?t.uploadImg(s.result):s.result;var i=new Image;i.src=o,console.log(i);var r=document.createElement("span");r.setAttribute("class","art-hide");var l=document.createTextNode("!["+n.name+"]("+o+")");r.appendChild(l);var a=e.target;a.appendChild(r),a.appendChild(i)},s.readAsDataURL(n)):L.message("不支持该文件类型","error")}},e}();function te(e,t){var o=document.createElement("a");o.download=t,o.style.display="none";var i=new Blob([e]);o.href=URL.createObjectURL(i),document.body.appendChild(o),o.click(),document.body.removeChild(o)}var oe=new Map;oe.set("plugin",te),oe.set("options",{name:"exportMdFile",init:function(e){function t(){te(e.editor.getMd(),"123.md")}function o(){!function(e){var t=document.createElement("input");t.type="file",t.accept=".md",t.style.display="none",document.body.appendChild(t),t.click(),t.onchange=function(){var o=new FileReader;o.onload=function(){console.log(o.result.toString()),e.editor.openFile(o.result.toString(),t.files[0].name),console.log(e.editor.editorHtmlNode)},o.readAsText(t.files[0],"utf8")},document.body.removeChild(t)}(e)}e.eventCenter.addFutureEvent("init-end",(function(){e.tool.addTool("导入",o),e.tool.addTool("导出",t)}))}});var ie=window,ne=function(){function e(e,t){void 0===t&&(t=new Map),this.container=e,this.config=new X(t),this.editor=new G(this,e),this.tool=new L(this,e),this.eventCenter=new ee(this,this.editor.editorHtmlDom)}return e.use=function(e,t){void 0===t&&(t=new Map);var o=new Map;o.set("plugin",e),o.set("options",t),this.plugins.push(o)},e.prototype.init=function(){this.registerPlugin(),this.editor.init(),this.config.runModel!=X.RunModel.read&&(this.tool.init(),this.eventCenter.init()),this.eventCenter.executeFutureEvent("init-end")},e.prototype.registerPlugin=function(){for(var t=0;t<e.plugins.length;t++)"uploadImg"==e.plugins[t].get("plugin").name&&(this.eventCenter.uploadImg=e.plugins[t].plugin),e.plugins[t].get("options").init&&e.plugins[t].get("options").init(this)},e.Editor=G,e.plugins=[oe],e}();ie.ArtText=ne;t.default=ne}]);